# Oh My Duo

[![Go](https://github.com/sb-child/OhMyDuo/actions/workflows/go.yml/badge.svg)](https://github.com/sb-child/OhMyDuo/actions/workflows/go.yml) ![GitHub release](https://img.shields.io/github/v/release/sb-child/OhMyDuo)

## [> View the English version of README <](./translate/en/)

~~ä½ æ˜¯ [Duolingo](https://duolingo.com/) çš„å¿ å®ç”¨æˆ·å—ï¼Ÿ~~

æœ¬ Repo å¯ä»¥å¸®åŠ©ä½ ç”Ÿæˆè‡ªå®šä¹‰çš„å¯çˆ±è´´çº¸ï¼

## demo

|                               é»˜è®¤å†…å®¹                               |
| :------------------------------------------------------------------: |
| <img src="https://my.sbchild.top:81/omd/_?x=fj32j340if" width="50%"> |
|                  https://my.sbchild.top:81 `/omd/_`                  |

|                                                   æ›´æ”¹è§’è‰²ï¼ŒåŸæ–‡å’Œç¿»è¯‘                                                   |
| :----------------------------------------------------------------------------------------------------------------------: |
| <img src="https://my.sbchild.top:81/omd/_?c=lily&o=do%20not%20talk%20with%20me&t=ä¸è¦å’Œæˆ‘è®²è¯&x=fyufyudtry" width="50%"> |
|                      https://my.sbchild.top:81 `/omd/_?c=lily&o=do not talk with me&t=ä¸è¦å’Œæˆ‘è®²è¯`                      |

ä½ åœ¨ç”¨ Telegram å˜›? å¿«å¿«è¯•è¯• <https://t.me/sbchild_bot> å§~

## ç”¨é€”

åˆ¶ä½œå¯çˆ±è´´çº¸ï¼è¿˜å¯ä»¥åœ¨è‡ªå·±çš„ä¸»é¡µä¸Šå±•ç¤ºï¼

## æ€ä¹ˆç”¨

0. `clone`æœ¬é¡¹ç›®, æˆ–ä¸‹è½½å‹ç¼©åŒ…å¹¶è§£å‹

> ä¸æƒ³è‡ªå·±ç¼–è¯‘çš„å¯ä»¥å» Release ![GitHub release](https://img.shields.io/github/v/release/sb-child/OhMyDuo) ä¸‹è½½é¢„ç¼–è¯‘ç‰ˆ

1. åœ¨ `manifest/config` ç›®å½•ä¸‹, å¤åˆ¶`config.example.toml`åˆ°`config.toml`, æŒ‰éœ€ç¼–è¾‘`config.toml`:

- æ›´æ”¹ HTTP ç›‘å¬ç«¯å£
- æ›´æ”¹ `rootDir` ä¸º URL åœ°å€å‰ç¼€
- æ›´æ”¹ `httpServer`ï¼Œå¦‚æœä¸éœ€è¦å¯ç”¨ HTTP æœåŠ¡ï¼Œè¯·å°†å€¼ä¿®æ”¹ä¸º `false`
- æ›´æ”¹ `telegramBotToken`ï¼Œå¦‚æœä¸éœ€è¦å¯ç”¨ Telegram Botï¼Œè¯·å°†å€¼ä¿®æ”¹ä¸ºç©º
- æ›´æ”¹ `telegramBotHttpTimeout`ï¼Œæ¨èè®¾ä¸º `3000`
- æ›´æ”¹ `telegramBotHttpProxy`ï¼Œå¦‚æœä¸éœ€è¦å¯ç”¨ Telegram ä»£ç†ï¼Œè¯·å°†å€¼ä¿®æ”¹ä¸ºç©º
- æ›´æ”¹ `telegramBotImageServer` ä¸º Telegram ä½¿ç”¨çš„ OhMyDuo åœ°å€

2. ç¼–è¯‘

- å‡†å¤‡å¥½`golang 1.20+`å’Œ`gfcli`ç¯å¢ƒ
- `./build.sh`

3. éƒ¨ç½²

- ç¡®ä¿`oh-my-duo-*`å’Œ`config.yaml`åœ¨åŒä¸€ç›®å½•ä¸‹
- è¿è¡Œ`oh-my-duo-*`
- (å¯é€‰) æŒ‰éœ€ä¿®æ”¹`OhMyDuo.service`, å¹¶æ‹·è´è‡³`/etc/systemd/system/OhMyDuo.service`, å³å¯åˆ›å»ºä¸€ä¸ª systemd æœåŠ¡
- æ¥ä¸‹æ¥ä½ å¯ä»¥å°è¯•ä½¿ç”¨ Web æœåŠ¡å™¨çš„åå‘ä»£ç†åŠŸèƒ½ï¼Œå¯ä»¥æ–¹ä¾¿ä½¿ç”¨ï¼Œä»¥åŠå…è®¸ Telegram ä»è¿™ä¸ªæœåŠ¡å™¨è¯·æ±‚å›¾ç‰‡!

4. æµ‹è¯•

- æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥`ä½ çš„åŸŸåæˆ–ipåœ°å€/ä½ çš„åœ°å€å‰ç¼€/_`ï¼Œä¾‹å¦‚`https://my.sbchild.top:81/omd/_`
- å¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€å¼ å¤šå„¿çš„ç…§ç‰‡ï¼Œæ­å–œä½ ï¼Œå®ƒèƒ½ç”¨å•¦

5. åˆ°åº•æ€ä¹ˆç”¨

ç›®å‰æœ‰ä¸¤ä¸ªæ–¹å¼è°ƒç”¨è¿™ä¸ªç”Ÿæˆå™¨:

1. åœ¨`/_`åé¢æ·»åŠ å‚æ•°, ç¬¬ä¸€ä¸ªå‚æ•°å‰åŠ ä¸Š`?`, å‚æ•°ä¹‹é—´ä½¿ç”¨`&`åˆ†éš”

- `/_` é»˜è®¤
- `/_?c=lily` æŒ‡å®šè§’è‰²ï¼Œä¸åŒºåˆ†å¤§å°å†™, é»˜è®¤ä¸º Duo
  - Duo
  - Bea
  - Vikram
  - Oscar
  - Junior
  - Eddy
  - Zari
  - Lily
  - Lin
  - Lucy
  - Falstaff
- `/_?o=text...` åŸæ–‡ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œç©ºæ ¼éœ€è¦ä½¿ç”¨`%20`ä»£æ›¿
- `/_?t=text...` è¯‘æ–‡(åŸæ–‡å’Œè¯‘æ–‡éœ€è¦ä¸€èµ·æŒ‡å®š)ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œç©ºæ ¼éœ€è¦ä½¿ç”¨`%20`ä»£æ›¿

2. åœ¨`/_/`åé¢æŒ‰ç…§å¦‚ä¸‹æ ¼å¼æŒ‡å®šå‚æ•°, å‚æ•°ä¹‹é—´ä½¿ç”¨`|`åˆ†éš”

- `/_/Hello-world|ä½ å¥½-ä¸–ç•Œ` é»˜è®¤ä½¿ç”¨ Duo è§’è‰², åŸæ–‡ä¸º`Hello world`, è¯‘æ–‡ä¸º`ä½ å¥½ ä¸–ç•Œ`ã€‚ç©ºæ ¼ä½¿ç”¨`-`ä»£æ›¿

- `/_/Can-you-speak--English%3f|ä½ ä¼šè®²è‹±è¯­å—ï¼Ÿ` åŸæ–‡ä¸º`Can you speak-English?`, è¯‘æ–‡ä¸º`ä½ ä¼šè®²è‹±è¯­å—ï¼Ÿ`ã€‚é—®å·`?`ä½¿ç”¨`%3f`ä»£æ›¿, è¿å­—ç¬¦`-`ä½¿ç”¨`--`ä»£æ›¿

- `/_/lucy|Can-you-speak--English%3f|ä½ ä¼šè®²è‹±è¯­å—ï¼Ÿ` æŒ‡å®š`Lucy`è§’è‰², åŸæ–‡ä¸º`Can you speak-English?`, è¯‘æ–‡ä¸º`ä½ ä¼šè®²è‹±è¯­å—ï¼Ÿ`

ä½†æ˜¯åœ¨ Telegram Bot ä¸­ï¼Œéœ€è¦è¿™æ ·ä½¿ç”¨:

- `@some_bot Hello world|ä½ å¥½ ä¸–ç•Œ` åˆ—å‡ºæ‰€æœ‰è§’è‰²çš„å›¾ç‰‡, åŸæ–‡ä¸º`Hello world`, è¯‘æ–‡ä¸º`ä½ å¥½ ä¸–ç•Œ`

- `@some_bot Can u speak english|ä½ èƒ½è®²è‹±è¯­å˜›|zari` ä½¿ç”¨ Zari è§’è‰², åŸæ–‡ä¸º`Can u speak english`, è¯‘æ–‡ä¸º`ä½ èƒ½è®²è‹±è¯­å˜›`

## TODO

- [ ] emoji æ”¯æŒ ğŸ˜Š
- [x] æ—¥æ–‡æ”¯æŒ
- [ ] è‡ªåŠ¨æˆªæ–­è¶…é•¿å•è¯
- [ ] æ›´å¤šè¯­è¨€æ——å¸œ (æ¬¢è¿ PR)

## è´¡çŒ®

æ¬¢è¿æäº¤ PR æ¥æ”¹è¿›è¿™ä¸ªç¨‹åº!

## æ¡†æ¶

[GoFrame](https://goframe.org)

## è®¸å¯è¯

Apache 2.0

## Makefile å­å‘½ä»¤

Project Makefile Commands:

- `make cli`: Install or Update to the latest GoFrame CLI tool.
- `make dao`: Generate go files for `Entity/DAO/DO` according to the configuration file from `hack` folder.
- `make service`: Parse `logic` folder to generate interface go files into `service` folder.
- `make image TAG=xxx`: Run `docker build` to build image according `manifest/docker`.
- `make image.push TAG=xxx`: Run `docker build` and `docker push` to build and push image according `manifest/docker`.
- `make deploy TAG=xxx`: Run `kustomize build` to build and deploy deployment to kubernetes server group according `manifest/deploy`.
